<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>채팅 입력 및 사이드바 레이아웃</title>

    <style>
        /* 폰트 정의 - 실제 경로는 더미입니다. */
        @font-face {
            font-family: 'KoreanSerif', serif; 
        }
        @font-face {
            font-family: 'Javanese Text';
        }

        /* ---------------------------------
            CSS 상수 정의 (가독성 및 일관성 확보)
            --------------------------------- */
        :root {
            /* 사이드바 메뉴가 정렬될 가상 박스의 너비 (중앙 몰림 효과) */
            --menu-box-width: 200px; 
            /* 폰트와 선 사이에 들어갈 공통 간격 (모든 4개 행의 폰트와 선 사이 간격) */
            --menu-spacer-gap: 15px; 
            
            /* 메뉴 항목의 공통 폰트 높이 (22px 폰트 기준) */
            --menu-font-height: 26px; 
            
            /* 폰트 너비 (22px 폰트 기준 대략적인 값) */
            --width-my: 35px;
            --width-voice: 75px;
            --width-avatar: 75px;
            --width-server: 75px;
            
            /* 메뉴 정렬 박스의 왼쪽/오른쪽 시작점 (291px 사이드바 폭에서 200px 박스를 중앙에 놓음) */
            --menu-offset: 45.5px; /* (291 - 200) / 2 = 45.5px */

            /* 맨 아래 구분선의 목표 너비 (짧게 만들기 위함) */
            --bottom-divider-width: 150px;
            
            /* 아바타 원형의 크기 */
            --circle-size: 72px;
            
            /* 햄버거 아이콘 크기 */
            --toggle-icon-width: 48px;
            --toggle-icon-height: 28px;
        }

        /* ---------------------------------
            BODY & APP-FRAME: 전체 화면 꽉 채우기
            --------------------------------- */
        body, html {
            margin: 0;
            padding: 0;
            overflow: hidden; /* 스크롤 방지 */
            height: 100%;
        }
        
        body {
            background: #261D23; 
            font-family: 'KoreanSerif', 'NanumMyeongjo', serif;
            color: white;
            display: flex; 
            justify-content: center;
            align-items: center; 
        }

        /* ---------------------------------
            1. 앱 프레임 (.app-frame)
            --------------------------------- */
        .app-frame {
            width: 100vw;
            height: 100vh; 
            position: relative; 
            display: flex;
            flex-direction: column;
            padding-top: 80px; 
        }
        
        /* ---------------------------------
            A. 메뉴 토글 아이콘 (고정 위치)
            --------------------------------- */
        /* 아이콘 컨테이너는 이제 Fixed로, 사이드바가 열리든 닫히든 동일한 위치에 고정됩니다. */
        .menu-toggle-icon-wrapper {
            position: fixed; 
            right: 40px; 
            top: 40px; 
            width: var(--toggle-icon-width);
            height: var(--toggle-icon-height);
            z-index: 700; /* 사이드바(z-index: 500) 위에 위치해야 함 */
            transition: all 0.4s ease-in-out; 
            cursor: pointer; /* 커서 추가 */
        }

        /* 햄버거 메뉴 아이콘 스타일 */
        .menu-toggle-icon {
            width: 100%;
            height: 100%;
            display: block;
        }

        .menu-toggle-icon:hover {
            transform: scale(1.1);
        }
        
        /* ---------------------------------
            2. 채팅 기록 영역
            --------------------------------- */
        .chat-history {
            width: 90%;
            max-width: 688px;
            flex-grow: 1; 
            margin: 40px auto 30px; 
            padding: 0 20px;
            overflow-y: auto; 
            background: transparent; 
            display: flex;
            flex-direction: column;
            gap: 15px; 
        }
        
        .chat-message {
            max-width: 80%;
            padding: 10px 15px;
            border-radius: 15px;
            font-size: 14px; 
            word-break: break-word;
            line-height: 1.7; 
        }

        .chat-message.user {
            background: #FF019B; 
            color: #1B1B1B; 
            align-self: flex-end; 
            border-bottom-right-radius: 5px;
        }
        
        .chat-message.system {
            background: #1B1B1B;
            color: white;
            align-self: flex-start; 
            border-bottom-left-radius: 5px;
        }

        /* ---------------------------------
            3. 입력 관련 스타일
            --------------------------------- */
        .input-controls-area {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 30px 0 60px; 
            z-index: 100;
            flex-shrink: 0; 
        }

        .input-box-background {
            width: 90%;
            max-width: 688px;
            height: 200px; 
            min-height: 120px;
            background: #1B1B1B;
            box-shadow: 0px 0px 30px rgba(255, 1, 155, 0.40); 
            border-radius: 20px;
            outline: 1px #FF019B solid;
            position: relative; 
        }
        
        .input-field {
            position: absolute;
            top: 0;
            left: 0;
            width: calc(100% - 40px);
            height: calc(100% - 40px);
            background: transparent;
            border: none; 
            resize: none;
            padding: 20px;
            color: white;
            font-size: 14px; 
            font-family: 'KoreanSerif', 'NanumMyeongjo', serif;
            font-weight: 600;
            line-height: 1.7; 
            outline: none; 
        }
        
        .input-field:focus {
            outline: none !important;
            box-shadow: none !important;
        }

        .input-field::placeholder {
            color: #888;
            font-weight: 400;
        }

        /* 전송 버튼 스타일 */
        .save-button-link {
            width: 163px;
            height: 58px;
            background: #FF019B; 
            border-radius: 100px;
            text-decoration: none;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            margin-top: 20px; 
            transition: all 0.2s ease;
            box-shadow: none; 
            z-index: 1000; 
        }

        .save-button-text {
            color: black;
            font-size: 28px;
            font-weight: 600;
        }
        
        /* ---------------------------------
            4. 로딩 팝업/모달 스타일
            --------------------------------- */
        .modal-overlay {
            display: none; 
            position: fixed; 
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 1000; 
        }

        .loading-popup-box {
            position: fixed; 
            top: 50%; 
            left: 50%;
            transform: translate(-50%, -50%); 
            width: 90%; 
            max-width: 589px; 
            height: 150px;
            background: #FF019B; 
            border-radius: 100px;
            z-index: 1001; 
            display: none; 
            align-items: center;
            justify-content: center;
            opacity: 0; 
            transition: opacity 0.3s ease, transform 0.3s ease; 
        }

        .loading-text {
            color: black;
            font-size: 28px;
            font-weight: 600;
        }
        
        /* ---------------------------------
            5. 사이드바 스타일 (메뉴 위치/정렬)
            --------------------------------- */
        
        /* 사이드바 컨테이너 (슬라이드) */
        .sidebar-container {
            position: fixed; /* Fixed로 변경하여 스크롤에 영향을 받지 않도록 함 */
            top: 0;
            right: 0;
            width: 291px;
            height: 100%; 
            z-index: 500; 
            overflow: hidden; 
            transition: transform 0.4s ease-in-out;
            transform: translateX(291px); /* 초기 상태: 완전히 화면 밖으로 숨김 */
        }
        .sidebar-container.sidebar-open {
            transform: translateX(0); /* OPEN 상태 */
        }

        .sidebar-header { 
            width: 100%; 
            height: 100px; 
            background: black; 
            position: relative; 
        }
        
        .sidebar-main { 
            width: 100%; 
            height: calc(100% - 100px); 
            background: #FF019B; 
            position: relative; 
            padding-top: 50px; 
        }
        
        /* B. 사이드바 내부 햄버거 아이콘 스타일 제거 (외부 아이콘만 사용) */

        /* ---------------------------------
            C. 메뉴 링크 및 구분선 정렬 (수치화된 중앙 정렬)
            --------------------------------- */
        
        /* 공통 스타일 (메뉴 링크) */
        .menu-link {
            color: black; 
            font-family: 'Javanese Text';
            font-size: 22px; 
            font-weight: 400;
            font-style: normal;
            line-height: normal;
            text-decoration: none; 
            display: block; 
            position: absolute;
            cursor: pointer;
            height: var(--menu-font-height); /* 26px */
            white-space: nowrap;
        }
        
        /* 공통 스타일 (구분선) */
        .divider {
            height: 1px; 
            outline: 1px black solid; 
            outline-offset: -0.50px;
            position: absolute;
        }
        
        /* 1. My (왼쪽 정렬) & Divider (오른쪽 정렬) */
        .menu-my { left: var(--menu-offset); top: 53px; }
        .divider-1 { 
            width: calc(var(--menu-box-width) - var(--width-my) - var(--menu-spacer-gap));
            right: var(--menu-offset); 
            /* 53px + 12.5px = 65.5px */
            top: 65.5px; 
        }

        /* 2. Divider (왼쪽 정렬) & Avatar (오른쪽 정렬) */
        .menu-avatar { right: var(--menu-offset); top: 143px; text-align: right; }
        .divider-3 { 
            width: calc(var(--menu-box-width) - var(--width-avatar) - var(--menu-spacer-gap));
            left: var(--menu-offset); 
            /* 143px + 12.5px = 155.5px */
            top: 155.5px; 
        }

        /* 3. Voice (왼쪽 정렬) & Divider (오른쪽 정렬) */
        .menu-voice { left: var(--menu-offset); top: 233px; }
        .divider-2 { 
            width: calc(var(--menu-box-width) - var(--width-voice) - var(--menu-spacer-gap));
            right: var(--menu-offset); 
            /* 233px + 12.5px = 245.5px */
            top: 245.5px; 
        }

        /* 4. Divider (왼쪽 정렬) & Server (오른쪽 정렬) */
        .menu-server { right: var(--menu-offset); top: 323px; text-align: right;}
        .divider-4 { 
            width: calc(var(--menu-box-width) - var(--width-server) - var(--menu-spacer-gap));
            left: var(--menu-offset); 
            /* 323px + 12.5px = 335.5px */
            top: 335.5px; 
        }
        
        /* 아바타 원형 테두리 (Avatar 메뉴 정중앙에 위치하도록 수정) */
        .menu-circle { 
            width: var(--circle-size); /* 72px */
            height: var(--circle-size); /* 72px */
            border-radius: 9999px; 
            border: 1px black solid; 
            position: absolute; 
            
            /* 세로 중앙 정렬: 143px(텍스트 top) + 13px(텍스트 중앙) - 36px(원 중앙) = 120px */
            top: 120px; 

            /* 가로 중앙 정렬 유지 */
            right: calc(var(--menu-offset) - (var(--circle-size) - var(--width-avatar)) / 2); 
        }

        /* --------------------------------------------------------------------------------------------------
            하단 푸터 영역 조정 
            -------------------------------------------------------------------------------------------------- */
        
        /* 하단 이미지 */
        .image-bottom { 
            width: var(--menu-box-width); /* 200px */
            height: 230px; 
            position: absolute; 
            left: var(--menu-offset); /* 45.5px */
            top: 410px; 
        }
        #imageBottom img {
            width: 100%; 
            height: 100%; 
            border-radius: 10px; 
            object-fit: cover;
        }

        /* 슬로건 및 구분선 (중앙 정렬) */
        .slogan-1 { 
            width: 100%; 
            position: absolute; 
            top: 670px; 
            text-align: center; 
            color: black; 
            font-size: 13px; 
            font-family: 'Javanese Text'; 
            font-weight: 400; 
            letter-spacing: 0.2em; 
        }
        .slogan-2 { 
            width: 100%;
            position: absolute; 
            top: 705px; 
            text-align: center; 
            color: black; 
            font-size: 10px; 
            font-family: 'Javanese Text'; 
            font-weight: 400; 
            letter-spacing: 0.2em; 
        }
        
        /* 마지막 구분선 (더 짧게, 더 아래로 이동) */
        .divider-bottom {
            width: var(--bottom-divider-width); /* 150px (짧아짐) */
            left: calc(50% - (var(--bottom-divider-width) / 2)); /* 사이드바 중앙 정렬 */
            top: 800px; /* 가장 아래로 이동 */
        }
        
    </style>
</head>
<body onload="initializeChat()"> 

    <!-- A. 메뉴 토글 아이콘 Wrapper (Fixed) -->
    <!-- 이 아이콘은 이제 사이드바가 열리든 닫히든 같은 위치에 고정되어 토글 역할을 수행합니다. -->
    <div id="menuToggleWrapper" class="menu-toggle-icon-wrapper" onclick="toggleSidebar()" title="메뉴 토글">
        <div id="menuToggle" class="menu-toggle-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="35" viewBox="0 0 48 35" fill="none">
                <path d="M0 31.5H48M0 17.5H48M0 3.5H48" stroke="#FF019B" stroke-width="7"/>
            </svg>
        </div>
    </div>

    <!-- 전체 화면 꽉 채우는 앱 프레임 -->
    <div id="appFrame" class="app-frame">
        
        <!-- 2. 채팅 기록 영역 -->
        <div id="chatHistory" class="chat-history">
            <!-- 초기 채팅 메시지가 여기에 추가됩니다. -->
        </div>

        <!-- 3. 입력 컨트롤 영역 -->
        <div class="input-controls-area">
            
            <div class="input-box-background">
                <textarea id="inputField" class="input-field" placeholder="내용을 입력하세요."></textarea>
            </div>
            
            <!-- 전송 버튼 -->
            <a class="save-button-link" onclick="sendMessage()" title="메시지 전송">
                <div class="save-button-text">전 송</div> 
            </a>
        </div>
    </div>
    
    <!-- 5. 사이드바 컨테이너 (슬라이드) -->
    <div id="sidebarContainer" class="sidebar-container">
        
        <!-- 헤더 및 메인 -->
        <div id="sidebarHeader" class="sidebar-header">
            <!-- 내부 햄버거 아이콘 제거 -->
        </div>
        
        <div id="sidebarMain" class="sidebar-main">
            
            <!-- 1. My (왼쪽 정렬) & Divider (오른쪽 정렬) -->
            <a id="menuMy" class="menu-link menu-my" href="6my.html">My</a>
            <div id="divider1" class="divider divider-1"></div>

            <!-- 2. Divider (왼쪽 정렬) & Avatar (오른쪽 정렬) -->
            <div id="divider3" class="divider divider-3"></div>
            <div id="menuAvatar" class="menu-link menu-avatar">Avatar</div> 

            <!-- 3. Voice (왼쪽 정렬) & Divider (오른쪽 정렬) -->
            <a id="menuVoice" class="menu-link menu-voice" href="12voice.html">Voice</a>
            <div id="divider2" class="divider divider-2"></div>

            <!-- 4. Divider (왼쪽 정렬) & Server (오른쪽 정렬) -->
            <div id="divider4" class="divider divider-4"></div>
            <div id="menuServer" class="menu-link menu-server">Server</div> 

            <!-- 아바타 원형 테두리 (선택됨 강조) -->
            <div id="menuCircle" class="menu-circle"></div>
            
            <!-- 하단 이미지 -->
            <div id="imageBottom" class="image-bottom">
                <img src="assets/image6.png" alt="Sidebar Bottom Image" onerror="this.onerror=null; this.src='https://placehold.co/200x230/FF019B/FFFFFF?text=Placeholder+Image';"/>
            </div>

            <!-- 슬로건 -->
            <div id="slogan1" class="slogan-1">Y o u , b u t v i r t u a l !</div>
            <div id="slogan2" class="slogan-2">Turn imagination into identity</div>
            
            <!-- 마지막 구분선 -->
            <div id="dividerBottom" class="divider divider-bottom"></div>

        </div>
    </div>


    <!-- 로딩 팝업/모달 -->
    <div id="modalOverlay" class="modal-overlay"></div>
    <div id="loadingPopup" class="loading-popup-box">
        <div class="loading-text">이미지를 생성 중입니다. . .</div>
    </div>

    <script>
        const chatHistory = document.getElementById('chatHistory');
        const inputField = document.getElementById('inputField');
        const modalOverlay = document.getElementById('modalOverlay');
        const loadingPopup = document.getElementById('loadingPopup');
        const menuToggleWrapper = document.getElementById('menuToggleWrapper'); 

        const sidebarContainer = document.getElementById('sidebarContainer');
        let isSidebarOpen = false;

        // 사이드바 열기/닫기 함수
        function toggleSidebar() {
            isSidebarOpen = !isSidebarOpen;
            
            if (isSidebarOpen) {
                // OPEN state: 사이드바 요소를 화면 안으로 당겨옴
                sidebarContainer.classList.add('sidebar-open');
                // 고정된 외부 아이콘은 그대로 남아 사이드바 헤더 위에 표시됩니다.
            } else {
                // CLOSED state: 사이드바 요소를 화면 밖으로 밀어냄
                sidebarContainer.classList.remove('sidebar-open');
                // 고정된 외부 아이콘은 그대로 남아 배경 위에 표시됩니다.
            }
        }

        // 초기 상태 설정
        function initializeChat() {
            // 사이드바 닫힘 상태로 시작 (CSS에서 이미 설정됨)
            // 햄버거 아이콘은 고정 위치에 항상 표시되므로 별도의 표시/숨김 로직이 필요 없음.

            // 1. 초기 채팅 메시지 표시
            const firstMessage = "안녕하세요! 원하시는 아바타 이미지를 입력해 주세요!";
            const secondMessage = "ex) 귀여운 느낌의 아이돌 소녀, 금발 긴 웨이브, 크고 반짝이는 분홍색 눈동자, 밝은 피부톤, 분홍색과 흰색의 귀여운 의상, 아이돌 애니메이션 스타일";

            setTimeout(() => {
                addMessage(firstMessage, 'system');
                setTimeout(() => {
                    addMessage(secondMessage, 'system');
                }, 1500); 
            }, 1000); 
        }

        // 메시지를 채팅 기록에 추가하는 함수
        function addMessage(text, senderClass) {
            if (!text.trim()) return;
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('chat-message', senderClass);
            messageDiv.textContent = text;
            chatHistory.appendChild(messageDiv);
            chatHistory.scrollTop = chatHistory.scrollHeight;
        }

        // '전송' 버튼 클릭 시 호출되는 함수
        function sendMessage() {
            const messageText = inputField.value;
            
            if (messageText.trim()) {
                // 1. 사용자 메시지 추가
                addMessage(messageText, 'user');
                inputField.value = '';

                // 2. 시스템 응답 및 로딩 시뮬레이션
                setTimeout(() => {
                    modalOverlay.style.display = 'block'; 
                    loadingPopup.style.display = 'flex'; 
                    loadingPopup.style.opacity = '1';

                    setTimeout(() => {
                        loadingPopup.style.opacity = '0';
                        modalOverlay.style.display = 'none';
                        loadingPopup.style.display = 'none';
                        
                        setTimeout(() => {
                            addMessage('이미지 생성이 완료되었습니다!', 'system');
                        }, 500); // 로딩 사라진 후 잠시 뒤 메시지 표시
                    }, 3000); 
                }, 1000); 
            }
        }
        
        // 엔터 키 입력 시 전송 (Shift + Enter는 줄바꿈)
        inputField.addEventListener('keydown', function(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault(); 
                sendMessage();
            }
        });
        
    </script>
</body>
</html>