<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>아바타 생성</title>
    <style>
        @font-face { font-family: 'KoreanSerif', serif; }
        @font-face { font-family: 'Javanese Text'; }
        :root {
            --menu-box-width: 200px;
            --menu-spacer-gap: 15px;
            --menu-font-height: 26px;
            --width-my: 35px; --width-voice: 75px; --width-avatar: 75px; --width-voicechanger: 150px;
            --menu-offset: 45.5px;
            --bottom-divider-width: 150px;
            --circle-size: 72px;
            --toggle-icon-width: 48px; --toggle-icon-height: 28px;
        }
        body, html { margin: 0; padding: 0; overflow: hidden; height: 100%; }
        body { background: #261D23; font-family: 'KoreanSerif', 'NanumMyeongjo', serif; color: white; display: flex; justify-content: center; align-items: center; }
        .app-frame { width: 100vw; height: 100vh; position: relative; display: flex; flex-direction: column; padding-top: 80px; }
        .menu-toggle-icon-wrapper { position: fixed; right: 40px; top: 40px; width: var(--toggle-icon-width); height: var(--toggle-icon-height); z-index: 700; transition: all 0.4s ease-in-out; cursor: pointer; }
        .menu-toggle-icon { width: 100%; height: 100%; display: block; }
        .menu-toggle-icon:hover { transform: scale(1.1); }
        .chat-history { width: 90%; max-width: 688px; flex-grow: 1; margin: 40px auto 30px; padding: 0 20px; overflow-y: auto; background: transparent; display: flex; flex-direction: column; gap: 15px; }
        .chat-message { max-width: 80%; padding: 10px 15px; border-radius: 15px; font-size: 14px; word-break: break-word; line-height: 1.7; }
        .chat-message.user { background: #FF019B; color: #1B1B1B; align-self: flex-end; border-bottom-right-radius: 5px; }
        .chat-message.system { background: #1B1B1B; color: white; align-self: flex-start; border-bottom-left-radius: 5px; }
        .input-controls-area { width: 100%; display: flex; justify-content: center; align-items: center; flex-direction: column; padding: 30px 0 60px; z-index: 100; flex-shrink: 0; }
        .input-box-background { width: 90%; max-width: 688px; height: 200px; min-height: 120px; background: #1B1B1B; box-shadow: 0px 0px 30px rgba(255, 1, 155, 0.40); border-radius: 20px; outline: 1px #FF019B solid; position: relative; }
        .input-field { position: absolute; top: 0; left: 0; width: calc(100% - 40px); height: calc(100% - 40px); background: transparent; border: none; resize: none; padding: 20px; color: white; font-size: 14px; font-family: 'KoreanSerif', 'NanumMyeongjo', serif; font-weight: 600; line-height: 1.7; outline: none; }
        .input-field::placeholder { color: #888; font-weight: 400; }
        .save-button-link { width: 163px; height: 58px; background: #FF019B; border-radius: 100px; text-decoration: none; display: flex; justify-content: center; align-items: center; cursor: pointer; margin-top: 20px; transition: all 0.2s ease; box-shadow: none; z-index: 1000; }
        .save-button-text { color: black; font-size: 28px; font-weight: 600; }
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1000; }
        .loading-popup-box { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90%; max-width: 589px; height: 150px; background: #FF019B; border-radius: 100px; z-index: 1001; display: none; align-items: center; justify-content: center; opacity: 0; transition: opacity 0.3s ease, transform 0.3s ease; }
        .loading-text { color: black; font-size: 28px; font-weight: 600; }
        .sidebar-container { position: fixed; top: 0; right: 0; width: 291px; height: 100%; z-index: 500; overflow: hidden; transition: transform 0.4s ease-in-out; transform: translateX(291px); }
        .sidebar-container.sidebar-open { transform: translateX(0); }
        .sidebar-header { width: 100%; height: 100px; background: black; position: relative; }
        .sidebar-main { width: 100%; height: calc(100% - 100px); background: #FF019B; position: relative; padding-top: 50px; }
        .menu-link { color: black; font-family: 'Javanese Text'; font-size: 22px; font-weight: 400; text-decoration: none; display: block; position: absolute; cursor: pointer; height: var(--menu-font-height); white-space: nowrap; }
        .divider { height: 1px; outline: 1px black solid; outline-offset: -0.50px; position: absolute; }
        .menu-my { left: var(--menu-offset); top: 53px; }
        .divider-1 { width: calc(var(--menu-box-width) - var(--width-my) - var(--menu-spacer-gap)); right: var(--menu-offset); top: 65.5px; }
        .menu-avatar { right: var(--menu-offset); top: 143px; text-align: right; }
        .divider-3 { width: calc(var(--menu-box-width) - var(--width-avatar) - var(--menu-spacer-gap)); left: var(--menu-offset); top: 155.5px; }
        .menu-voice { left: var(--menu-offset); top: 233px; }
        .divider-2 { width: calc(var(--menu-box-width) - var(--width-voice) - var(--menu-spacer-gap)); right: var(--menu-offset); top: 245.5px; }
        .menu-voicechanger { right: var(--menu-offset); top: 323px; text-align: right; font-size: 20px; }
        .divider-4 { width: calc(var(--menu-box-width) - var(--width-voicechanger) - var(--menu-spacer-gap)); left: var(--menu-offset); top: 335.5px; }
        .menu-circle { width: var(--circle-size); height: var(--circle-size); border-radius: 9999px; border: 1px black solid; position: absolute; top: 120px; right: calc(var(--menu-offset) - (var(--circle-size) - var(--width-avatar)) / 2); }
        .image-bottom { width: var(--menu-box-width); height: 230px; position: absolute; left: var(--menu-offset); top: 410px; }
        .slogan-1 { width: 100%; position: absolute; top: 670px; text-align: center; color: black; font-size: 13px; font-family: 'Javanese Text'; font-weight: 400; letter-spacing: 0.2em; }
        .slogan-2 { width: 100%; position: absolute; top: 705px; text-align: center; color: black; font-size: 10px; font-family: 'Javanese Text'; font-weight: 400; letter-spacing: 0.2em; }
        .divider-bottom { width: var(--bottom-divider-width); left: calc(50% - (var(--bottom-divider-width) / 2)); top: 800px; }
    </style>
</head>
<body onload="initializeChat()">

    <div id="menuToggleWrapper" class="menu-toggle-icon-wrapper" onclick="toggleSidebar()" title="메뉴 토글">
        <div id="menuToggle" class="menu-toggle-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="35" viewBox="0 0 48 35" fill="none">
                <path d="M0 31.5H48M0 17.5H48M0 3.5H48" stroke="#FF019B" stroke-width="7"/>
            </svg>
        </div>
    </div>

    <div id="appFrame" class="app-frame">
        <div id="chatHistory" class="chat-history"></div>
        <div class="input-controls-area">
            <div class="input-box-background">
                <textarea id="inputField" class="input-field" placeholder="내용을 입력하세요."></textarea>
            </div>
            <a class="save-button-link" onclick="sendMessage()" title="메시지 전송">
                <div class="save-button-text">전 송</div>
            </a>
        </div>
    </div>

    <div id="sidebarContainer" class="sidebar-container">
        <div id="sidebarHeader" class="sidebar-header"></div>
        <div id="sidebarMain" class="sidebar-main">
            <a id="menuMy" class="menu-link menu-my" href="index.html">My</a>
            <div id="divider1" class="divider divider-1"></div>
            <div id="divider3" class="divider divider-3"></div>
            <div id="menuAvatar" class="menu-link menu-avatar">Avatar</div>
            <a id="menuVoice" class="menu-link menu-voice" href="voice.html">Voice</a>
            <div id="divider2" class="divider divider-2"></div>
            <div id="divider4" class="divider divider-4"></div>
            <div id="menuVoiceChanger" class="menu-link menu-voicechanger">VoiceChanger</div>
            <div id="menuCircle" class="menu-circle"></div>
            <div id="imageBottom" class="image-bottom">
                <img src="assets/image6.png" alt="Sidebar Bottom Image" onerror="this.onerror=null; this.src='https://placehold.co/200x230/FF019B/FFFFFF?text=Placeholder+Image';"/>
            </div>
            <div id="slogan1" class="slogan-1">Y o u , b u t v i r t u a l !</div>
            <div id="slogan2" class="slogan-2">Turn imagination into identity</div>
            <div id="dividerBottom" class="divider divider-bottom"></div>
        </div>
    </div>

    <div id="modalOverlay" class="modal-overlay"></div>
    <div id="loadingPopup" class="loading-popup-box">
        <div class="loading-text">이미지를 생성 중입니다. . .</div>
    </div>

    <script>
        const chatHistory = document.getElementById('chatHistory');
        const inputField = document.getElementById('inputField');
        const modalOverlay = document.getElementById('modalOverlay');
        const loadingPopup = document.getElementById('loadingPopup');
        const sidebarContainer = document.getElementById('sidebarContainer');
        let isSidebarOpen = false;

        function toggleSidebar() {
            isSidebarOpen = !isSidebarOpen;
            if (isSidebarOpen) sidebarContainer.classList.add('sidebar-open');
            else sidebarContainer.classList.remove('sidebar-open');
        }

        function initializeChat() {
            const firstMessage = "안녕하세요! 원하시는 아바타 이미지를 입력해 주세요!";
            const secondMessage = "ex) 귀여운 느낌의 아이돌 소녀, 금발 긴 웨이브, 크고 반짝이는 분홍색 눈동자, 밝은 피부톤, 분홍색과 흰색의 귀여운 의상, 아이돌 애니메이션 스타일";
            setTimeout(() => {
                addMessage(firstMessage, 'system');
                setTimeout(() => { addMessage(secondMessage, 'system'); }, 1500);
            }, 1000);
        }

        function addMessage(text, senderClass) {
            if (!text || !text.trim()) return;
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('chat-message', senderClass);
            messageDiv.textContent = text;
            chatHistory.appendChild(messageDiv);
            chatHistory.scrollTop = chatHistory.scrollHeight;
        }

        function sendMessage() {
            const messageText = inputField.value;
            if (messageText.trim()) {
                addMessage(messageText, 'user');
                inputField.value = '';
                setTimeout(() => {
                    modalOverlay.style.display = 'block';
                    loadingPopup.style.display = 'flex';
                    loadingPopup.style.opacity = '1';
                    setTimeout(() => {
                        loadingPopup.style.opacity = '0';
                        modalOverlay.style.display = 'none';
                        loadingPopup.style.display = 'none';
                        setTimeout(() => { addMessage('이미지 생성이 완료되었습니다!', 'system'); }, 500);
                    }, 3000);
                }, 1000);
            }
        }

        // VoiceChanger 실행 IPC
        try {
            const { ipcRenderer } = require('electron');
            const vbtn = document.getElementById('menuVoiceChanger');
            if (vbtn) {
                vbtn.addEventListener('click', (ev) => {
                    ev.preventDefault();
                    ipcRenderer.send('start-voice-changer');
                });
            }
        } catch (_) {}
    </script>
</body>
</html>


